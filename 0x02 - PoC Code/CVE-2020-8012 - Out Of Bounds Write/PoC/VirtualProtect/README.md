# Sing About Me Im Dying Of Thirst


In this directory you'll find the PoC version of the Sing About Me Im Dying Of Thirst exploit. When launched the nimcontroller will remain in an IDLE state. You'll still get a shell but the service will remain unavailable to system administrators. I've decided not to include the method allowing execution to continue in order to prevent worms (IR should spot multiple IDLE services quick). Apart from that, the exploit is as stable as it gets.

This is by far the most critical vulnerability found during my research on the Nimbus protocol and the most interesting. After gaining RIP control, the battle had just begun as x64 userland exploitation is not well documented. In fact this may be the first public example of a x64 userland vulnerability in Windows (NOT KERNEL OR WOW64). The only other case I've seen of this being done is in [Geluchat's](https://twitter.com/geluchat?lang=en) blog here: https://www.dailysecurity.fr/windows_exploit_64_bits_rop/ .


## Usage

```
root@kali:~# ./singAboutMeImDyingOfThirst
usage: ./singAboutMeImDyingOfThirst [-h] [-t TARGET] [-p PORT] [ARG=VAL]

Sing About Me Im Dying Of Thirst - A nimcontroller's worst nightmare

optional arguments:
  -h, --help                  show this help message and exit
  -t TARGET, --target TARGET  target host to probe
  -p PORT, --port PORT        nimcontroller port

examples:
  ./singAboutMeImDyingOfThirst -t 192.168.88.130 -p 48000
```

Below is a screenshot of the POC tested on the newest version of Windows 10 Pro (at time of development). Within the snapshots directory of this repository I have also included a `webm` demonstrating exploitation.

![alt text](https://github.com/wetw0rk/CA-UIM-Nimbus-Research/blob/master/0xFF%20-%20Screenshots/Out%20Of%20Bounds%20Write/poc_release.png)
